# ggsave(puberty_plot, filename = paste0(proj_path, "script_output/puberty_by_age.png"), width=8, height=8, units='in', dpi=300, bg = "transparent")
# puberty_plot_grade <- ggplot(puberty,
#                        aes(x = grade,
#                            y = stage,
#                            group = tagid,
#                            col = tagid)) +
#   geom_point(alpha=1) +
#   geom_line(alpha=.4) +
#   ggtitle("Puberty Progression Modeled by Grade in School")+
#   theme(legend.position = "none") +
#   xlab("Grade in School") +
#   ylab("Tanner Stage")+
#   theme_minimal(base_size = 26)+
#   theme(legend.position = "none",
#         text = element_text(family = "Tahoma", color = "#330000"))
# ggsave(puberty_plot_grade, filename = paste0(proj_path, "script_output/puberty_by_grade.png"), width=8, height=8, units='in', dpi=300, bg = "transparent")
## correlation between age and grade
#cor.test(puberty_sr_tagid$age, puberty_sr_tagid$grade)
# super correlated = 0.9573725
## cleaning environment
rm(puberty_plot, timing_tempo_plot)
View(aparc)
library(mgcv)
View(puberty)
gammmm <- gamm(stage ~ s(timing_at_midpub, bs = "cs", k = 4) + s(tempo, bs = "cs", k = 4) + s(timing_at_midpub, tempo), data = puberty)
summary(gammmm)
summary(gammmm)$lme
summary(gammmm$lme)
gammmm <- gamm(stage ~ s(timing_at_midpub, bs = "cs", k = 4) + s(tempo, bs = "cs", k = 4) + s(timing_at_midpub, tempo), random = list(tagid = ~1), data = puberty)
summary(gammmm$lme)
## cleaning up cortical quantification
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w")
## filtering to include participants with both brain and puberty data
aparc <- aparc[which(aparc$tagid %in% puberty$tagid),]
## removing _thickness so that the dk atlas from ggseg and our data matches up
colnames(aparc) <-  sub("_thickness", "", colnames(aparc))
colnames(aparc) <-  sub(".thickness", "", colnames(aparc))
## setting up our model
## The LOOP
## make a long format file with all the data
data <- aparc %>%
select( -lh_MeanThickness, -BrainSegVolNotVent.x, -BrainSegVolNotVent.y, -eTIV.x, -eTIV.y) %>%
pivot_longer(cols=3:73, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
View(aparc)
data <- aparc %>%
select( -lh_MeanThickness, -BrainSegVolNotVent.1, -BrainSegVolNotVent-eTIV.1, -eTIV) %>%
pivot_longer(cols=3:73, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
data <- aparc %>%
select( -lh_MeanThickness, -BrainSegVolNotVent.1, -eTIV.1, ) %>%
pivot_longer(cols=3:73, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w")
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
View(aparc)
## removing random first column
aparc <- aparc[-1]
View(aparc)
View(aparc)
View(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w")
View(aparc)
View(puberty)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
str(aparc)
## cleaning tagid for cortical quants
aparc <- aparc %>%
separate(tagid, into = c("tag_part", "extra"), sep = "w", remove = FALSE) %>%
mutate(wave = as.numeric(gsub("[^0-9]", "", extra))) %>%
select(tagid, tag_part = tag_part, wave) %>%
filter(!is.na(wave))
View(aparc)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
aparc <- aparc %>%
separate(tagid, into = c("tag_part", "extra"), sep = "w", remove = FALSE) %>%
mutate(wave = as.numeric(gsub("[^0-9]", "", extra))) %>%
filter(!is.na(wave))
View(aparc)
View(aparc)
aparc <- aparc %>%
mutate(wave = as.numeric(gsub("[^0-9]", "", extra))) %>%
filter(!is.na(wave))
View(aparc)
## cleaning tagid for cortical quants
aparc <- aparc %>%
separate(tagid, into = c("tag_part", "extra"), sep = "w", remove = FALSE) %>%
mutate(wave = as.numeric(sub("^(\\d+).*", "\\1", extra))) %>%
filter(!is.na(wave))
View(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w")
View(aparc)
str(aparc$wave)
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w") %>%
mutate(wave = str_extract(wave, "^\\d{2}"))
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "wave"), sep = "w") %>%
mutate(wave = str_extract(wave, "^\\d{2}"))
View(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}"))
View(aparc)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}"))
View(aparc)
str(aparc)
aparc <- aparc[which(aparc$tagid %in% puberty$tagid),]
colnames(aparc) <-  sub("_thickness", "", colnames(aparc))
colnames(aparc) <-  sub(".thickness", "", colnames(aparc))
View(aparc)
View(gammmm)
View(aparc)
str(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness, -lh_MeanThickness)
View(aparc)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness, -lh_MeanThickness)
View(aparc)
str(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness_thickness, -lh_MeanThickness_thickness)
View(aparc)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness_thickness, -lh_MeanThickness_thickness, -hold)
View(aparc)
data <- aparc %>%
pivot_longer(cols=2:72, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
aparc <- aparc[which(aparc$tagid %in% puberty$tagid),]
colnames(aparc) <-  sub("_thickness", "", colnames(aparc))
colnames(aparc) <-  sub(".thickness", "", colnames(aparc))
data <- aparc %>%
pivot_longer(cols=2:72, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
View(aparc)
str(aparc)
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness_thickness, -lh_MeanThickness_thickness, -hold, -tagid.1)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, BrainSegVolNotVent, BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness_thickness, -lh_MeanThickness_thickness, -hold, -tagid.1)
View(aparc)
str(aparc)
aparc <- read.csv(paste0(q_path, "script_docs/aparc_all.csv"))
## removing random first column
aparc <- aparc[-1]
## cleaning tagid for cortical quants
library("stringr")
aparc <- aparc %>%
separate(., tagid, c("tagid", "hold"), sep = "w") %>%
mutate(wave = str_extract(hold, "^\\d{2}")) %>%
select(-by, -eTIV.1, -BrainSegVolNotVent, -BrainSegVolNotVent.1, -eTIV, -rh_MeanThickness_thickness, -lh_MeanThickness_thickness, -hold, -tagid.1)
aparc <- aparc[which(aparc$tagid %in% puberty$tagid),]
colnames(aparc) <-  sub("_thickness", "", colnames(aparc))
colnames(aparc) <-  sub(".thickness", "", colnames(aparc))
View(aparc)
data <- aparc %>%
pivot_longer(cols=2:69, names_to = "region", values_to = "thickness") %>%
mutate(tagid = as.factor(tagid),
wave = as.factor(wave))
View(data)
data <- left_join(data, (puberty %>% select(tagid, wave, age, stage, tempo, timing_at_midpub)))
View(data)
View(aparc)
regionsofinterest <- colnames(aparc)[2:69]
library(mgcv)
all_thickness_models <- lapply(X = 1:length(regionsofinterest),
FUN = function(X){
model_data <- data %>%
filter(region == regionsofinterest[X])
regionname = as.character(regionsofinterest[X])
## GAMM approach
assign(paste0("gammmod_ageonly_", regionname),
gamm(thickness ~ s(age,bs = "cs",k = 4),
random = list(tagid = ~1),
data = (model_data)))
assign(paste0("gammmod_maintempo_", regionname),
gamm(thickness ~ tempo + s(age,bs = "cs", k = 4),
random = list(tagid = ~1),
data = (model_data)))
assign(paste0("gammmod_maintiming_", regionname),
gamm(thickness ~ timing_at_midpub + s(age,bs = "cs", k = 4),
random = list(tagid = ~1),
data = (model_data)))
modcomparetiming = anova(get(paste0("gammmod_ageonly_", regionname))$lme, get(paste0("gammmod_maintiming_",regionname))$lme)
modcomparetempo = anova(get(paste0("gammmod_ageonly_", regionname))$lme, get(paste0("gammmod_maintempo_",regionname))$lme)
print(regionname)
GAMMLRmaintimingpval = modcomparetiming$`p-value`[2]
GAMMLRtempopval = modcomparetempo$`p-value`[2]
GAMMtiming_fixedcoef = round(summary(get(paste0("gammmod_maintiming_", regionname))$lme)[["coefficients"]][["fixed"]][["Xtiming"]], digits = 3)
GAMMtempo_fixedcoef = round(summary(get(paste0("gammmod_maintempo_", regionname))$lme)[["coefficients"]][["fixed"]][["Xtempo"]], digits = 3)
### LME approach
LME_just_age_timing <- lmer(thickness ~ age + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_main_timing <- lmer(thickness ~ age + timing_at_midpub + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_int_timing <- lmer(thickness ~ age * timing_at_midpub + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_just_age_tempo <- lmer(thickness ~ age + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_main_tempo <- lmer(thickness ~ age + tempo + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_int_tempo <- lmer(thickness ~ age * tempo + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
comparetimingLME <- anova(LME_just_age_timing, LME_main_timing, LME_int_timing)
comparetempoLME <- anova(LME_just_age_tempo, LME_main_tempo, LME_int_tempo)
LMELRtimingpvalmain = comparetimingLME$`Pr(>Chisq)`[2]
LMELRtimingpvalint = comparetimingLME$`Pr(>Chisq)`[3]
LMELRtempopvalmain = comparetempoLME$`Pr(>Chisq)`[2]
LMELRtempopvalint = comparetempoLME$`Pr(>Chisq)`[3]
LME_main_timing_timingcoef = round(summary(LME_main_timing)[["coefficients"]][3], digits = 3)
LME_int_timing_intcoef = round(summary(LME_int_timing)[["coefficients"]][3], digits = 3)
LME_main_tempo_tempocoef = round(summary(LME_main_tempo)[["coefficients"]][3], digits = 3)
LME_int_tempo_intcoef = round(summary(LME_int_tempo)[["coefficients"]][3], digits = 3)
cbind(regionname,
GAMMLRmaintimingpval,
GAMMLRtempopval,
GAMMtiming_fixedcoef,
GAMMtempo_fixedcoef,
LMELRtimingpvalmain,
LMELRtimingpvalint,
LMELRtempopvalmain,
LMELRtempopvalint,
LME_main_timing_timingcoef,
LME_int_timing_intcoef,
LME_main_tempo_tempocoef,
LME_int_tempo_intcoef
)
})
all_thickness_models <- lapply(X = 1:length(regionsofinterest),
FUN = function(X){
model_data <- data %>%
filter(region == regionsofinterest[X])
regionname = as.character(regionsofinterest[X])
## GAMM approach
assign(paste0("gammmod_ageonly_", regionname),
gamm(thickness ~ s(age,bs = "cs",k = 4),
random = list(tagid = ~1),
data = (model_data)))
assign(paste0("gammmod_maintempo_", regionname),
gamm(thickness ~ tempo + s(age,bs = "cs", k = 4),
random = list(tagid = ~1),
data = (model_data)))
assign(paste0("gammmod_maintiming_", regionname),
gamm(thickness ~ timing_at_midpub + s(age,bs = "cs", k = 4),
random = list(tagid = ~1),
data = (model_data)))
modcomparetiming = anova(get(paste0("gammmod_ageonly_", regionname))$lme, get(paste0("gammmod_maintiming_",regionname))$lme)
modcomparetempo = anova(get(paste0("gammmod_ageonly_", regionname))$lme, get(paste0("gammmod_maintempo_",regionname))$lme)
print(regionname)
GAMMLRmaintimingpval = modcomparetiming$`p-value`[2]
GAMMLRtempopval = modcomparetempo$`p-value`[2]
GAMMtiming_fixedcoef = round(summary(get(paste0("gammmod_maintiming_", regionname))$lme)[["coefficients"]][["fixed"]][["Xtiming_at_midpub"]], digits = 3)
GAMMtempo_fixedcoef = round(summary(get(paste0("gammmod_maintempo_", regionname))$lme)[["coefficients"]][["fixed"]][["Xtempo"]], digits = 3)
### LME approach
LME_just_age_timing <- lmer(thickness ~ age + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_main_timing <- lmer(thickness ~ age + timing_at_midpub + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_int_timing <- lmer(thickness ~ age * timing_at_midpub + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_just_age_tempo <- lmer(thickness ~ age + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_main_tempo <- lmer(thickness ~ age + tempo + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
LME_int_tempo <- lmer(thickness ~ age * tempo + (1 | tagid),
data = (model_data %>% filter(!is.na(tempo),
!is.na(timing_at_midpub))),
REML = FALSE)
comparetimingLME <- anova(LME_just_age_timing, LME_main_timing, LME_int_timing)
comparetempoLME <- anova(LME_just_age_tempo, LME_main_tempo, LME_int_tempo)
LMELRtimingpvalmain = comparetimingLME$`Pr(>Chisq)`[2]
LMELRtimingpvalint = comparetimingLME$`Pr(>Chisq)`[3]
LMELRtempopvalmain = comparetempoLME$`Pr(>Chisq)`[2]
LMELRtempopvalint = comparetempoLME$`Pr(>Chisq)`[3]
LME_main_timing_timingcoef = round(summary(LME_main_timing)[["coefficients"]][3], digits = 3)
LME_int_timing_intcoef = round(summary(LME_int_timing)[["coefficients"]][3], digits = 3)
LME_main_tempo_tempocoef = round(summary(LME_main_tempo)[["coefficients"]][3], digits = 3)
LME_int_tempo_intcoef = round(summary(LME_int_tempo)[["coefficients"]][3], digits = 3)
cbind(regionname,
GAMMLRmaintimingpval,
GAMMLRtempopval,
GAMMtiming_fixedcoef,
GAMMtempo_fixedcoef,
LMELRtimingpvalmain,
LMELRtimingpvalint,
LMELRtempopvalmain,
LMELRtempopvalint,
LME_main_timing_timingcoef,
LME_int_timing_intcoef,
LME_main_tempo_tempocoef,
LME_int_tempo_intcoef
)
})
output_thickness_models <- data.frame(matrix(unlist(all_thickness_models),
nrow = length(all_thickness_models),
byrow = TRUE)) %>%
mutate(regionname = X1,
GAMMLRmaintimingpval = X2,
GAMMLRtempopval = X3,
GAMMtiming_fixedcoef = X4,
GAMMtempo_fixedcoef = X5,
LMELRtimingpvalmain = X6,
LMELRtimingpvalint = X7,
LMELRtempopvalmain = X8,
LMELRtempopvalint = X9,
LME_main_timing_timingcoef = X10,
LME_int_timing_intcoef = X11,
LME_main_tempo_tempocoef = X12,
LME_int_tempo_intcoef = X13) %>%
select(-X1, -X2, -X3, -X4, -X5, -X6, -X7, -X8, -X9, -X10, -X11, -X12, -X13)
View(output_thickness_models)
write.csv(output_thickness_models, file = "output_thickness_all_models.csv")
knitr::opts_chunk$set(
echo = TRUE,
message = TRUE,
warning = TRUE
)
options(scipen=999)
# load packages
library(pacman)
pacman::p_load(dplyr, lme4, nlme, ggplot2, tidyr, lubridate, psych, saemix, lavaan, install = TRUE)
# cas_dir = "/Volumes/psych-cog/dsnlab/TAG/"
# proj_path = "/Volumes/psych-cog/dsnlab/TAG/projects/timing_tempo_tag/"
# q_path = "/Volumes/psych-cog/dsnlab/TAG/behavior/Questionnaires/"
root = "/Users/clare/Dropbox (University of Oregon)/mine/projects/timing_tempo_tag/"
## for puberty self-report variables
puberty_sr <- read.csv(paste0(root, "Allwaves_PubertyComposite_2024.05.07.csv")) %>%
mutate(tagid=as.factor(tagid),
wave=as.factor(wave)) %>%
select(tagid, wave, age, PBIP_1A, PBIP_2A, stage, pdss, PUBcomp)
puberty_sr <- puberty_sr %>%
distinct(tagid, wave, .keep_all = TRUE)
puberty_wide <- puberty_sr %>%
select(tagid, wave, stage) %>%
pivot_wider(names_from = "wave", values_from = "stage") %>%
rename("pub1" = "1",
"pub2" = "2",
"pub3" = "3",
"pub4" = "4",
"pub5" = "5")
age_wide <- puberty_sr %>%
select(tagid, wave, age) %>%
pivot_wider(names_from = "wave", values_from = "age") %>%
rename("age1" = "1",
"age2" = "2",
"age3" = "3",
"age4" = "4",
"age5" = "5")
puberty_wide <- full_join(puberty_wide, age_wide, by = "tagid")
## REMOVE REGRESSING CASES
# regressing_ids <- puberty_sr %>%
#   arrange(tagid, wave) %>%
#   group_by(tagid) %>%
#   mutate(stage_diff = stage - lag(stage)) %>%
#   filter(stage_diff < 0) %>%
#   select(id) %>%
#   distinct()
#
# puberty_sr <- puberty_sr %>%
#   filter(!(tagid %in% regressing_ids$tagid))
# add color for wave
means <- puberty_sr %>%
filter(!is.na(stage)) %>%
group_by(wave) %>%
summarize(mean = mean(stage))
plot(means, ylim=c(1,5),
xlab = "Time",
ylab = "Pubertal Status",
main = "Plot of means for Pubertal Status",
pch = 16)
puberty_sr %>%
ggplot(aes(age, stage, group = tagid)) +
geom_line(alpha = 0.1) +
stat_smooth(aes(group=1),
method = "lm", formula = y ~ x + I(x^2), size = 1.5,
level = 0.95,
color = "blue") +
theme_classic() +
labs(x = "Age", y = "Pubertal Status", title = "Pubertal Status")
# logistic model with random effects
logistic_model <- function(age, b0, b1, alpha, lambda) {
b0 + (b1 - b0) * (1 / (1 + exp(-alpha * (age - lambda)))) }
# the starting values for the parameters
## we're saying 0.9 is the avg rate of pubertal dev & 13.5 is the avg age of mid-puberty
start_vals <- list(fixed = c(alpha = 0.9, lambda = 13.5))
# removing NAs for now but there could be some sort of fancy way to deal with this
puberty_sr <- puberty_sr %>%
filter(!is.na(stage) & !is.na(age) & !is.na(tagid))
# fit THE nonlinear mixed effects model
## set lower asym at stage 1 and upper asym at stage 5, grouping by tagid
fit <- nlme(stage ~ logistic_model(age, 1, 5, alpha, lambda),
data = puberty_sr,
fixed = alpha + lambda ~ 1,
random = pdDiag(alpha + lambda ~ 1),
groups = ~ tagid,
start = start_vals, method = "ML")
# the fitted values
## predicted stage based on an individual's age
fitted_values <- fitted(fit)
# the individual parameter estimates
## alpha = more pos values --> slower dev, more neg values --> faster dev
## lambda = more pos values --> later mid-pubertal peak, more neg values --> earlier mid-pubertal peak
individual_estimates <- ranef(fit)
# summary
summary(fit)
# individual estimates + wide
individual_estimates_df <- data.frame(id = rownames(individual_estimates), individual_estimates) %>%
rename("tagid" = "id")
puberty_wide <- left_join(puberty_wide, individual_estimates_df, by = "tagid")
write.csv(puberty_wide, file = "puberty_wide_plus_alpha_lambda.csv")
puberty_plot <- cbind(fitted_values, puberty_sr)
puberty_plot <- left_join(puberty_plot, individual_estimates_df, by = "tagid")
#write.csv(puberty_plot, file = "puberty_long_plus_alpha_lambda.csv")
fitted_values_plot <- ggplot(data = puberty_plot, aes(x = age, y = fitted_values, color = tagid)) +
geom_point(aes(y = fitted_values), size = 1, shape = 16) +
geom_line(aes(y = fitted_values), size = 0.5, linetype = "solid") +
labs(
title = "predicted values - log model",
x = "age",
y = "predicted pubertal stage",
color = "tagid"
) +
theme_minimal() +
theme(legend.position = "none")
print(fitted_values_plot)
View(individual_estimates)
View(individual_estimates_df)
fixed_plot <- ggplot(puberty_sr, aes(x = age, y = stage, color = tagid)) +
geom_line(aes(y = fitted_values), linetype = "dashed") +
labs(title = "Fitted (Fixed) Logistic Growth Curves",
x = "Age",
y = "Pubertal Stage") +
theme_minimal()+
theme(legend.position = "none")
print(fixed_plot)
